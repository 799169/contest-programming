<html><head>
	<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">
	<meta http-equiv="content-language" content="pl">
  <meta name="Description" content="MAIN to portal edukacyjny dla wszystkich zainteresowanych informatyk±, a szczególnie algorytmik±. Zawiera archiwum zadañ algorytmicznych, kurs programowania i algorytmiki, liczne artyku³y i tutoriale, forum dyskusyjne oraz inne przydatne informacje.">
  <meta name="Keywords" content="algorytmika,algorytmiczny,algorytmiczne,informatyka,informatyczna,akademia,kurs,Pascal,C++,TopCoder,Olimpiada Informatyczna,UVA,konkursy,artyku³y,forum,portal,PA,testy,archiwum,zadañ,MAIN">
  <meta name="Revisit-after" content="10 days">
<!-- base href="http://main.edu.pl/en/" -->
	<link rel="stylesheet" type="text/css" href="lam_files/style.css">
	<link rel="stylesheet" type="text/css" href="lam_files/punbb.css">
	<link rel="stylesheet" type="text/css" href="lam_files/punbb_global.css">
  <link rel="shortcut icon" type="image/x-icon" href="http://main.edu.pl/en/img/main.ico">
	<script src="lam_files/scripts.js" type="text/javascript"></script>
	<title>M³odzie¿owa Akademia Informatyczna (MAIN)</title>
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0">

<table id="topbanner" cellpadding="0" cellspacing="0">
  <tbody><tr><td class="left"></td><td class="middle_stretch"></td>
  <td class="right">
    <div class="cont1"></div>
    <div style="position: relative; height: 100%; top: 10px;">
    <div style="position: absolute; bottom: 0px; right: 0px;" class="use_default_styles">
      <form method="GET" action="">
        <select name="lang" onchange="this.form.submit()">
          <option value="pl">Polski</option>
          <option value="en" selected="selected">English</option>
        </select>
      </form>
    </div>
    </div>
  </td></tr>
</tbody></table>

<div style="background-position: 1554px 0px;" id="main"><div id="main_">
  <div id="menus">
    <div class="menu_open"><div id="image_mainmenu"></div></div>
    <div class="menu_content"><a href="http://main.edu.pl/en/user.phtml?op=news" class="level1">Home</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=archive" class="level1active">Task Archive</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=oi_list" class="level2active">OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=2200" class="level3">XXII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=2100" class="level3active">XXI OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania" class="level4active">Tasks</a>
<a href="http://main.edu.pl/en/user.phtml?op=submit&amp;m=insert" class="level4">Submit a solution</a>
<a href="http://main.edu.pl/en/user.phtml?op=zgloszenia" class="level4">My submissions</a>
<a href="http://main.edu.pl/en/user.phtml?op=zasoby" class="level4">Useful Resources</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=2000" class="level3">XX OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1900" class="level3">XIX OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1800" class="level3">XVIII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1700" class="level3">XVII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1600" class="level3">XVI OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1500" class="level3">XV OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1400" class="level3">XIV OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1300" class="level3">XIII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1200" class="level3">XII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1100" class="level3">XI OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1000" class="level3">X OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=900" class="level3">IX OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=800" class="level3">VIII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=700" class="level3">VII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=600" class="level3">VI OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=500" class="level3">V OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=400" class="level3">IV OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=300" class="level3">III OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=200" class="level3">II OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=100" class="level3">I OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=oig_list" class="level2">OIG</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=pa_list" class="level2">PA</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=ceoi_list" class="level2">CEOI</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=boi_list" class="level2">BOI</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=ioi_list" class="level2">IOI</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=ontak_list" class="level2">ONTAK</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=ilocamp_list" class="level2">ILOCAMP</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=amppz_list" class="level2">AMPPZ</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=courses" class="level1">Courses (PL)</a>
<a href="http://main.edu.pl/en/user.phtml?op=contact" class="level1">Contact Us</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=userinfo" class="level1">Update Personal Info</a>
<a href="http://main.edu.pl/en/user.phtml?op=skin" class="level1">Skins</a>
<a href="http://main.edu.pl/en/user.phtml?op=logout" class="level1">Sign out</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=about" class="level1">About</a>
</div>
		<div class="menu_close"><div id="image_menuclose"></div></div>
		<!--<div class='menu_open'><p>Drugie menu</p></div>
		<div class='menu_content'>
			<a href='#' class='level1'>Strona g?ówna</a>
			<a href='#' class='level1'>Download</a>
			<a href='#' class='level1'>Kontakt</a>
		</div>
		<div class='menu_close'></div>-->
    <!--
    Partner: <br/>
    <a href="http://www.google.com">
    <img width="150" style="margin: 12px;" src="/img/google.png">
    </a>
    -->
	</div>

<!-- foo -->
	<div id="body" class="use_default_styles"><a href="http://main.edu.pl/en/user.phtml?op=submit&amp;m=insert&amp;default=1198&amp;c=2100">&lt;Submit a solution&gt;</a> [<span style="background-color: yellow">0/100</span>]<div style="float: right; border: 1px solid black; padding: .5em"><b>Task statistics</b><br>Number of users: 31<br>Number of users with 100 points: 6<br>Average result: 50.9032 <div></div></div><h1>Solar lamps</h1>
<h3>Memory limit: 128 MB</h3>

<p>
Byteasar has a large and pretty garden.
As he would like to be able to appreciate its beauty even after dusk,
he installed lamps across the garden.
</p>
<p>
The lamps are directional, i.e., they illuminate only a certain angle, common to them all.
Moreover, Byteasar has aligned them so that they all face the same direction.
Last but not least, these are solar lamps, i.e., they come with solar panels
but no batteries, strangely enough!  You might think the panels are thus useless,
and each lamp will require electricity at night, but not quite: A lamp will produce light
if a sufficient number of lamps illuminate it.
</p>
<p>
By now, Byteasar has even come up with an order he is going supply the lamps with electricity,
thus turning them on.
For simplicity, we number the lamps from 1 to <span class="texmath"><img src="lam_files/lam-en-tex_016.png"></span> in this order, i.e., the lamp no. <span class="texmath"><img src="lam_files/lam-en-tex_009.png"></span>
is supplied with electricity at time <span class="texmath"><img src="lam_files/lam-en-tex_014.png"></span>.  The only thing left for Byteasar (and you, of course!) is to
figure out when exactly each lamp will start emitting light.  Help Byteasar by writing a program
that will determine the answer to this question.
</p>
  <h2>Input</h2>
<p>
The first line of the standard input contains a single integer <span class="texmath"><img src="lam_files/lam-en-tex_025.png"></span>
(<span class="texmath"><img src="lam_files/lam-en-tex_011.png"></span>): the number of lamps Byteasar installed.
In the second line of input, there are four integers <span class="texmath"><img src="lam_files/lam-en-tex_024.png"></span>
(<span class="texmath"><img src="lam_files/lam-en-tex_031.png"></span>, <span class="texmath"><img src="lam_files/lam-en-tex_035.png"></span>), separated by single spaces,
that describe the area illuminated by every lamp.
Namely, if there is a lamp located at the point <span class="texmath"><img src="lam_files/lam-en-tex_034.png"></span>, then it illuminates
the area (together with its edge) within the smaller of the two angles formed by two
rays that both originate at <span class="texmath"><img src="lam_files/lam-en-tex_033.png"></span> such that the <span class="texmath"><img src="lam_files/lam-en-tex_032.png"></span>-th (for <span class="texmath"><img src="lam_files/lam-en-tex_036.png"></span>) ray passes through
<span class="texmath"><img src="lam_files/lam-en-tex_018.png"></span>.  This angle is always smaller than <span class="texmath"><img src="lam_files/lam-en-tex_023.png"></span> degrees.
</p>
<p>
The <span class="texmath"><img src="lam_files/lam-en-tex_015.png"></span> input lines that follow specify the locations of the lamps:
the <span class="texmath"><img src="lam_files/lam-en-tex_012.png"></span>-th such line contains two integers <span class="texmath"><img src="lam_files/lam-en-tex_021.png"></span>,
(<span class="texmath"><img src="lam_files/lam-en-tex_030.png"></span>) separated by a single space,
that indicate that the lamp no. <span class="texmath"><img src="lam_files/lam-en-tex_022.png"></span> is located at the point <span class="texmath"><img src="lam_files/lam-en-tex_026.png"></span>.
You may assume that no two lamps share their location.
</p>
<p>
The last line of the input contains <span class="texmath"><img src="lam_files/lam-en-tex_017.png"></span> integers <span class="texmath"><img src="lam_files/lam-en-tex_028.png"></span> (<span class="texmath"><img src="lam_files/lam-en-tex_019.png"></span>),
separated by single spaces, that signify that if the lamp no. <span class="texmath"><img src="lam_files/lam-en-tex_027.png"></span> is in the area illuminated by
at least <span class="texmath"><img src="lam_files/lam-en-tex_010.png"></span> other lamps, then it will start emitting light as well.
</p>
<p>
In tests worth <span class="texmath"><img src="lam_files/lam-en-tex_029.png"></span> of the total score, it holds that <span class="texmath"><img src="lam_files/lam-en-tex_020.png"></span>.
</p>
  <h2>Output</h2>
<p>
Your program should print out to the standard output a single line with <span class="texmath"><img src="lam_files/lam-en-tex_006.png"></span> integers
<span class="texmath"><img src="lam_files/lam-en-tex_008.png"></span>, separated by single spaces.
The number <span class="texmath"><img src="lam_files/lam-en-tex.png"></span> should be the time when the lamp no. <span class="texmath"><img src="lam_files/lam-en-tex_013.png"></span> starts producing light.
</p>

<h2>Example</h2>

<p>For the input data:</p><pre>5
3 1 1 3
2 1
1 4
3 4
5 6
5 2
1 2 1 3 2
</pre>
<p>the correct result is:</p><pre>1 2 1 2 5
</pre>

<p><img src="lam_files/lam.png"></p>

<p>

<b>Explanation:</b> At time 1 Byteasar powers on the lamp 1, which also causes the lamp 3 to produce light.
Once the lamp 2 is powered on, the lamp 4 begins to emit light (being illuminated by lamps 1, 2, and 3).
</p>

<p><b>Sample grading tests:</b></p>
<ul>

    <li><tt>1ocen:</tt> <span class="texmath"><img src="lam_files/lam-en-tex_002.png"></span>, a small random test;
  </li>
    <li><tt>2ocen:</tt> <span class="texmath"><img src="lam_files/lam-en-tex_007.png"></span>, the lamps illuminate a zero angle (Byteasar bought lasers by mistake);
  </li>
    <li><tt>3ocen:</tt> <span class="texmath"><img src="lam_files/lam-en-tex_005.png"></span>, the lamps form a <span class="texmath"><img src="lam_files/lam-en-tex_003.png"></span> grid and illuminate a <span class="texmath"><img src="lam_files/lam-en-tex_004.png"></span> degree angle with its sides parallel to the Cartesian coordinate system axes.
</li>
   </ul>

<p><i>Task author: Wojciech Nadara.</i></p><a href="http://main.edu.pl/en/user.phtml?op=submit&amp;m=insert&amp;default=1198&amp;c=2100">&lt;Submit a solution&gt;</a> [<span style="background-color: yellow">0/100</span>]</div>
<div style="height: 300px"></div>

</div></div>

<table id="bottom_banner" cellpadding="0" cellspacing="0">
	<tbody><tr><td class="left"></td><td class="middle_stretch"></td><td class="right"></td></tr>
</tbody></table>


<script>
start();
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="lam_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
try {
  var pageTracker = _gat._getTracker("UA-822856-1");
  pageTracker._setDomainName("main.edu.pl");
  pageTracker._trackPageview();
} catch(err) {}
</script>
</body></html>