<html><head>
	<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">
	<meta http-equiv="content-language" content="pl">
  <meta name="Description" content="MAIN to portal edukacyjny dla wszystkich zainteresowanych informatyk±, a szczególnie algorytmik±. Zawiera archiwum zadañ algorytmicznych, kurs programowania i algorytmiki, liczne artyku³y i tutoriale, forum dyskusyjne oraz inne przydatne informacje.">
  <meta name="Keywords" content="algorytmika,algorytmiczny,algorytmiczne,informatyka,informatyczna,akademia,kurs,Pascal,C++,TopCoder,Olimpiada Informatyczna,UVA,konkursy,artyku³y,forum,portal,PA,testy,archiwum,zadañ,MAIN">
  <meta name="Revisit-after" content="10 days">
<!-- base href="http://main.edu.pl/en/" -->
	<link rel="stylesheet" type="text/css" href="waz_files/style.css">
	<link rel="stylesheet" type="text/css" href="waz_files/punbb.css">
	<link rel="stylesheet" type="text/css" href="waz_files/punbb_global.css">
  <link rel="shortcut icon" type="image/x-icon" href="http://main.edu.pl/en/img/main.ico">
	<script src="waz_files/scripts.js" type="text/javascript"></script>
	<title>M³odzie¿owa Akademia Informatyczna (MAIN)</title>
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0">

<table id="topbanner" cellpadding="0" cellspacing="0">
  <tbody><tr><td class="left"></td><td class="middle_stretch"></td>
  <td class="right">
    <div class="cont1"></div>
    <div style="position: relative; height: 100%; top: 10px;">
    <div style="position: absolute; bottom: 0px; right: 0px;" class="use_default_styles">
      <form method="GET" action="">
        <select name="lang" onchange="this.form.submit()">
          <option value="pl">Polski</option>
          <option value="en" selected="selected">English</option>
        </select>
      </form>
    </div>
    </div>
  </td></tr>
</tbody></table>

<div style="background-position: 1554px 0px;" id="main"><div id="main_">
  <div id="menus">
    <div class="menu_open"><div id="image_mainmenu"></div></div>
    <div class="menu_content"><a href="http://main.edu.pl/en/user.phtml?op=news" class="level1">Home</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=archive" class="level1active">Task Archive</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=oi_list" class="level2active">OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=2200" class="level3">XXII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=2100" class="level3active">XXI OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania" class="level4active">Tasks</a>
<a href="http://main.edu.pl/en/user.phtml?op=submit&amp;m=insert" class="level4">Submit a solution</a>
<a href="http://main.edu.pl/en/user.phtml?op=zgloszenia" class="level4">My submissions</a>
<a href="http://main.edu.pl/en/user.phtml?op=zasoby" class="level4">Useful Resources</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=2000" class="level3">XX OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1900" class="level3">XIX OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1800" class="level3">XVIII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1700" class="level3">XVII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1600" class="level3">XVI OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1500" class="level3">XV OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1400" class="level3">XIV OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1300" class="level3">XIII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1200" class="level3">XII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1100" class="level3">XI OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=1000" class="level3">X OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=900" class="level3">IX OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=800" class="level3">VIII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=700" class="level3">VII OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=600" class="level3">VI OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=500" class="level3">V OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=400" class="level3">IV OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=300" class="level3">III OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=200" class="level3">II OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=zadania&amp;c=100" class="level3">I OI</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=oig_list" class="level2">OIG</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=pa_list" class="level2">PA</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=ceoi_list" class="level2">CEOI</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=boi_list" class="level2">BOI</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=ioi_list" class="level2">IOI</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=ontak_list" class="level2">ONTAK</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=ilocamp_list" class="level2">ILOCAMP</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=amppz_list" class="level2">AMPPZ</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=courses" class="level1">Courses (PL)</a>
<a href="http://main.edu.pl/en/user.phtml?op=contact" class="level1">Contact Us</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=userinfo" class="level1">Update Personal Info</a>
<a href="http://main.edu.pl/en/user.phtml?op=skin" class="level1">Skins</a>
<a href="http://main.edu.pl/en/user.phtml?op=logout" class="level1">Sign out</a>
<a href="http://main.edu.pl/en/user.phtml?op=show&amp;page=about" class="level1">About</a>
</div>
		<div class="menu_close"><div id="image_menuclose"></div></div>
		<!--<div class='menu_open'><p>Drugie menu</p></div>
		<div class='menu_content'>
			<a href='#' class='level1'>Strona g?ówna</a>
			<a href='#' class='level1'>Download</a>
			<a href='#' class='level1'>Kontakt</a>
		</div>
		<div class='menu_close'></div>-->
    <!--
    Partner: <br/>
    <a href="http://www.google.com">
    <img width="150" style="margin: 12px;" src="/img/google.png">
    </a>
    -->
	</div>

<!-- foo -->
	<div id="body" class="use_default_styles"><a href="http://main.edu.pl/en/user.phtml?op=submit&amp;m=insert&amp;default=1127&amp;c=2100">&lt;Submit a solution&gt;</a> [<span style="background-color: yellow">0/100</span>]<div style="float: right; border: 1px solid black; padding: .5em"><b>Task statistics</b><br>Number of users: 22<br>Number of users with 100 points: 0<br>Average result: 31.5909 <div></div></div><h1>Snake</h1>
<h3>Memory limit: 512 MB</h3>

<p>
  A snake fills a <span class="texmath"><img src="waz_files/waz-en-tex_021.png"></span> board completely.
  Successive segments of the snake are numbered from <span class="texmath"><img src="waz_files/waz-en-tex_008.png"></span> to <span class="texmath"><img src="waz_files/waz-en-tex_015.png"></span>.
  The segments with successive numbers (i.e., 1 and 2, 2 and 3, 3 and 4...) occupy squares
  that share an edge.
  For example, a snake can fill a <span class="texmath"><img src="waz_files/waz-en-tex_017.png"></span> board as follows:
</p>
 <p align="center">
  <img src="waz_files/wazrys.png"></p>
<p>
     
  The snake's segment numbers in some of the squares have been erased.
  Can you reconstruct the snake?
</p>
  <h2>Input</h2>
<p>
  In the first line of the standard input, there is a single integer <span class="texmath"><img src="waz_files/waz-en-tex_014.png"></span>
  (<span class="texmath"><img src="waz_files/waz-en-tex_010.png"></span>), the length of the board.
  The three lines that follow describe the board;
  the <span class="texmath"><img src="waz_files/waz-en-tex_026.png"></span>-th of them contains <span class="texmath"><img src="waz_files/waz-en-tex_022.png"></span> integers <span class="texmath"><img src="waz_files/waz-en-tex_013.png"></span>
  (<span class="texmath"><img src="waz_files/waz-en-tex_019.png"></span> for <span class="texmath"><img src="waz_files/waz-en-tex_016.png"></span>).
  If <span class="texmath"><img src="waz_files/waz-en-tex_024.png"></span>, then <span class="texmath"><img src="waz_files/waz-en-tex_023.png"></span> is the number of the snake's segment
  occupying the <span class="texmath"><img src="waz_files/waz-en-tex_012.png"></span>-th square of the <span class="texmath"><img src="waz_files/waz-en-tex_009.png"></span>-th row of the board.
  If on the other hand <span class="texmath"><img src="waz_files/waz-en-tex_011.png"></span>, then the number of the snake's segment
  on this square is unknown.
</p>
<p>
  In tests worth 15% of the total score <span class="texmath"><img src="waz_files/waz-en-tex_002.png"></span> holds,
  in those worth 40% of the total score <span class="texmath"><img src="waz_files/waz-en-tex_006.png"></span> holds,
  and finally, in those worth 70% of the total score <span class="texmath"><img src="waz_files/waz-en-tex_004.png"></span> holds.
</p>
  <h2>Output</h2>
<p>
  Your program is to print three lines to the standard output.
  The <span class="texmath"><img src="waz_files/waz-en-tex_003.png"></span>-th lines should hold <span class="texmath"><img src="waz_files/waz-en-tex_020.png"></span> positive integers <span class="texmath"><img src="waz_files/waz-en-tex_007.png"></span> (for <span class="texmath"><img src="waz_files/waz-en-tex.png"></span>).
  All the numbers <span class="texmath"><img src="waz_files/waz-en-tex_018.png"></span> together should be a permutation of the numbers from <span class="texmath"><img src="waz_files/waz-en-tex_005.png"></span> to <span class="texmath"><img src="waz_files/waz-en-tex_025.png"></span>.
  The output numbers should be a valid reconstruction of the snake, i.e., they should
  be consistent with the (positive) input numbers and satisfy aforementioned constraints.
</p>
<p>
  You may assume that there is at least one valid reconstruction of the snake.
  If there is more than one, your program can print any valid reconstruction.
</p>
  <h2>Example</h2>
  <p>For the input data:</p><pre>9
0 0 5 0 17 0 0 0 21
8 0 0 3 16 0 0 25 0
0 0 0 0 0 0 0 0 23
</pre>
<p>the correct result is:</p><pre>7 6 5 4 17 18 19 20 21
8 1 2 3 16 15 26 25 22
9 10 11 12 13 14 27 24 23
</pre>
<p><i>Task author: Jakub Radoszewski.</i></p><a href="http://main.edu.pl/en/user.phtml?op=submit&amp;m=insert&amp;default=1127&amp;c=2100">&lt;Submit a solution&gt;</a> [<span style="background-color: yellow">0/100</span>]</div>
<div style="height: 300px"></div>

</div></div>

<table id="bottom_banner" cellpadding="0" cellspacing="0">
	<tbody><tr><td class="left"></td><td class="middle_stretch"></td><td class="right"></td></tr>
</tbody></table>


<script>
start();
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="waz_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
try {
  var pageTracker = _gat._getTracker("UA-822856-1");
  pageTracker._setDomainName("main.edu.pl");
  pageTracker._trackPageview();
} catch(err) {}
</script>
</body></html>